# Enbed API — v1

Embedded insurance API for integrating insurance products into checkout flows, lending journeys, and digital platforms.

---

## Base URL

```
UAT:        https://api-uat.ensuredit.com/enbed/v1
Production: https://api.ensuredit.com/enbed/v1
```

---

## Authentication

<span class="method-post">POST</span> `/auth/generate`

Generate an access token using your credentials.

**Request:**
```json
{
  "username": "your_username",
  "password": "your_password"
}
```

**Response** `200 OK`:
```json
{
  "accessToken": "<bearer_token>",
  "expiresIn": 1800,
  "refreshExpiresIn": 863999,
  "refreshToken": "<refresh_token>"
}
```

> Use the `accessToken` as `Authorization: Bearer <token>` in all subsequent requests.

---

## Get Products

<span class="method-post">POST</span> `/products/buyable`

Retrieve a list of available insurance products, optionally filtered by customer attributes.

**Query Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `size` | integer | Yes | Number of products per page |
| `page_number` | integer | No | Page number (default: 1) |

**Request Body:**

```json
{
  "search": "",
  "pre_quote": {
    "TAD_OR_MAD": "",
    "AGE": "",
    "REPAYMENT_CYCLE": "",
    "LOAN_AMOUNT": "",
    "MOBILE_NUMBER": ""
  },
  "include_actual_price": true,
  "include_benefits": true
}
```

**Response** `200 OK`:
```json
{
  "products": [
    {
      "id": "uuid-string",
      "name": "Product Name",
      "source": "Insurer Name",
      "startingFromPrice": 81,
      "paymentMethods": ["DEBIT"],
      "benefits": [...],
      "duration": "MONTHLY",
      "category": "HEALTH",
      "price": 81
    }
  ],
  "totalCount": 15
}
```

---

## Get Product Benefits

<span class="method-get">GET</span> `/products/:id/benefits`

Retrieve the detailed benefit list for a specific product.

**Path Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `id` | uuid | Yes | Product ID |

**Response** `200 OK`:
```json
{
  "benefits": [
    {
      "id": "3bad20d8-a67d-47c6-a410-82909a48c446",
      "benefit": "Accidental Death Benefit upto ₹1,00,000",
      "description": "Coverage for accidental death...",
      "included": true
    }
  ]
}
```

---

## Save Proposal

<span class="method-post">POST</span> `/policy-stores`

Submit a proposal form to create a policy store entry. This validates customer data and prepares the policy for purchase.

**Request Body:**

```json
{
  "product_id": "uuid-string",
  "proposal_form": {
    "CUSTOMER_ID": "CUST001",
    "FULL_NAME": "John Doe",
    "MOBILE_NUMBER": "9876543210",
    "EMAIL": "john@example.com",
    "STATE": "Karnataka",
    "PINCODE": "560001",
    "CITY": "Bangalore",
    "ADDRESS": "123 Main Street",
    "GENDER": "MALE",
    "OCCUPATION": "SALARIED",
    "DATE_OF_BIRTH": "1990-01-15",
    "ACCOUNT_NUMBER": "1234567890",
    "ACCOUNT_IFSC": "SBIN0001234",
    "ACCOUNT_CATEGORY": "SAVINGS",
    "NOMINEE_NAME": "Jane Doe",
    "NOMINEE_DOB": "1992-05-20",
    "NOMINEE_RELATIONSHIP": "SPOUSE",
    "NOMINEE_MOBILE_NUMBER": "9876543211",
    "START_DATE": "2026-02-15",
    "END_DATE": "2027-02-14"
  }
}
```

**Response** `200 OK`:
```json
{
  "id": "24c98711-9999-4869-9399-0baa4fa8fe21",
  "status": "PROPOSAL_SUBMITTED",
  "amount": 81
}
```

---

## Buy Product

<span class="method-post">POST</span> `/products/buy/client`

Complete the policy purchase after payment is collected.

**Request Body:**
```json
{
  "policy_id": "1134fada-1ef4-4916-aeae-0eedb67fe6ba",
  "payment_details": {
    "transaction_id": "TXN-2026-001",
    "amount": 130
  }
}
```

**Response** `200 OK`:
```json
{
  "transactionId": "TXN-2026-001",
  "amount": 130,
  "certificateNumber": "POL-2026-12345"
}
```

---

## Download Certificate

<span class="method-get">GET</span> `/policy-stores/:id/certificate:download`

Download the policy certificate as a PDF.

**Path Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `id` | uuid | Yes | Policy ID or Policy Store ID |

**Response** `200 OK`:
```json
{
  "url": "https://storage.ensuredit.com/certificates/POL-2026-12345.pdf"
}
```

---

## Raise Cancellation

<span class="method-post">POST</span> `/cancellations`

Submit a policy cancellation request with bank details for refund.

**Request Body:**
```json
{
  "policyId": "24c98711-9999-4869-9399-0baa4fa8fe21",
  "payload": {
    "BANK_ACCOUNT_NUMBER": "253749362649376",
    "BANK_ACCOUNT_HOLDER": "John Doe",
    "BANK_ACCOUNT_IFSC": "SBIN0001234"
  }
}
```

**Response** `200 OK`:
```json
{
  "id": "438f91cd-e6f4-4148-8384-da65f59ae3a7",
  "organizationId": "d9c3ed3f-375d-4d10-9ee0-8078d53d5fdc",
  "policyId": "24c98711-9999-4869-9399-0baa4fa8fe21",
  "refundAmount": 81,
  "status": "IN_PROCESS",
  "createdAt": "2026-02-12T11:25:25.497978Z",
  "updatedAt": "2026-02-12T11:25:25.497978Z"
}
```

---

## Get Cancellations

<span class="method-get">GET</span> `/cancellations`

Retrieve cancellation requests by policy ID or policy number.

**Query Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `policyId` | uuid | Optional | Filter by Policy ID |
| `policyNumber` | string | Optional | Filter by Policy Number |

**Response** `200 OK`:
```json
{
  "cancellations": [
    {
      "id": "41543f8c-6a68-4123-9103-b0ddb97bad60",
      "organizationId": "de60eeac-77b3-4585-aafa-c3cdb543a5f7",
      "policyId": "24c98711-9999-4869-9399-0baa4fa8fe21",
      "refundAmount": 109.20,
      "status": "IN_PROCESS",
      "createdAt": "2026-02-10T11:36:56.706870Z",
      "updatedAt": "2026-02-10T11:36:56.706870Z"
    }
  ]
}
```

**Cancellation Statuses:** `IN_PROCESS` | `APPROVED` | `REJECTED` | `REFUNDED`
